<ion-header>
  <ion-toolbar class="bg-transparent text-neon-cyan" style="--background: transparent;">
    <ion-title class="font-bold">AquaBalance Pro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="bg-ocean-dark text-text-main" style="--background: #05161A;">
  <section class="px-5 pt-6 pb-4 space-y-4">
    <div class="bg-ocean-card rounded-2xl shadow-lg border border-white/5 p-5">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs uppercase tracking-wide text-text-muted">Dispositivo</p>
          <h2 class="text-lg font-bold text-text-main">{{ deviceName }}</h2>
          <p class="text-xs text-text-muted mt-1">
            Horario: {{ status?.time || 'aguardando atualizacao' }}
          </p>
          <p class="text-xs text-text-muted" *ngIf="status?.apIp">
            AP: {{ status?.apIp }}
          </p>
        </div>
        <div class="flex flex-col items-end gap-2">
          <span
            class="flex items-center gap-2 rounded-full px-3 py-1 text-xs"
            [class]="
              status?.wifiConnected
                ? 'bg-neon-cyan text-ocean-dark font-bold shadow-neon'
                : 'border border-ocean-light text-text-muted'
            "
          >
            <ion-icon name="wifi"></ion-icon>
            Wi-Fi
          </span>
          <span
            class="flex items-center gap-2 rounded-full px-3 py-1 text-xs"
            [class]="
              status?.firebaseReady
                ? 'bg-neon-cyan text-ocean-dark font-bold shadow-neon'
                : 'border border-ocean-light text-text-muted'
            "
          >
            <ion-icon name="cloud"></ion-icon>
            Cloud
          </span>
        </div>
      </div>
    </div>

    <div class="bg-ocean-card rounded-2xl shadow-lg border border-white/5 p-5">
      <h3 class="text-base font-semibold text-text-main">Passo a passo</h3>
      <ol class="mt-3 space-y-2 text-sm text-text-muted list-decimal list-inside">
        <li>Conecte o celular ao Wi-Fi do ESP32.</li>
        <li>Toque em "Atualizar status".</li>
        <li>Abra o dispositivo para configurar as bombas.</li>
      </ol>
    </div>
  </section>

  <div class="px-5 pb-12 space-y-4">
    <button
      type="button"
      class="w-full bg-gradient-to-r from-teal-dim to-neon-cyan text-white font-bold rounded-xl py-4 shadow-lg active:scale-95 transition-transform disabled:opacity-60 disabled:cursor-not-allowed"
      (click)="refreshStatus()"
      [disabled]="isLoading"
    >
      <ion-spinner *ngIf="isLoading" name="dots" class="text-white"></ion-spinner>
      <span *ngIf="!isLoading">Atualizar status</span>
    </button>

    <button
      type="button"
      class="w-full border border-neon-cyan text-neon-cyan rounded-xl py-3"
      *ngIf="canConfigure"
      (click)="openConfig()"
    >
      Configurar {{ deviceName }}
    </button>

    <button
      type="button"
      class="w-full border border-neon-cyan text-neon-cyan rounded-xl py-3"
      *ngIf="canConfigure"
      (click)="openLogs()"
    >
      Log de registros
    </button>

    <button
      type="button"
      class="w-full border border-ocean-light text-text-muted rounded-xl py-3"
      (click)="openConfigPreview()"
    >
      Ver layout da configuracao
    </button>
  </div>

  <ion-toast
    [isOpen]="toastOpen"
    [message]="toastMessage"
    duration="2200"
    (didDismiss)="toastOpen = false"
  ></ion-toast>
</ion-content>
