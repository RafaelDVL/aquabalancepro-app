<ion-header>
  <ion-toolbar class="app-toolbar">
    <ion-title>AquaBalance Pro</ion-title>
  </ion-toolbar>
  <ion-toolbar class="device-toolbar">
    <div class="device-inline">
      <span class="device-name">{{ deviceName }}</span>
      <span class="device-time">Hor√°rio: {{ status?.time || 'aguardando atualizacao' }}</span>
      <span class="device-ap" *ngIf="status?.apIp">AP: {{ status?.apIp }}</span>
      <div class="status-inline">
        <ion-chip [color]="status?.wifiConnected ? 'success' : 'danger'">
          <ion-icon name="wifi"></ion-icon>
          <ion-label>Wi-Fi</ion-label>
        </ion-chip>
        <ion-chip [color]="status?.firebaseReady ? 'success' : 'danger'">
          <ion-icon name="cloud"></ion-icon>
        </ion-chip>
      </div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content class="home-page">
  <section class="hero">
    <div>
      <h1>Rede AquaBalancePro</h1>
      <p>Conecte o celular ao Wi-Fi do ESP32 para configurar as bombas.</p>
    </div>
    <ion-button expand="block" (click)="refreshStatus()" [disabled]="isLoading">
      <ion-spinner *ngIf="isLoading" name="dots"></ion-spinner>
      <span *ngIf="!isLoading">Atualizar status</span>
    </ion-button>
    <ion-button *ngIf="canConfigure" expand="block" (click)="openConfig()">
      Configurar {{ deviceName }}
    </ion-button>
    <ion-button expand="block" fill="outline" (click)="openConfigPreview()">
      Ver layout da configuracao
    </ion-button>
  </section>

  <ion-card class="info-card">
    <ion-card-content>
      <h3>Passo a passo</h3>
      <ol>
        <li>Conecte o celular ao Wi-Fi do ESP32.</li>
        <li>Toque em "Atualizar status".</li>
        <li>Abra o dispositivo para configurar as bombas.</li>
      </ol>
    </ion-card-content>
  </ion-card>

  <ion-toast
    [isOpen]="toastOpen"
    [message]="toastMessage"
    duration="2200"
    (didDismiss)="toastOpen = false"
  ></ion-toast>
</ion-content>
